<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>区域明细</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" type="text/css" href="/css/easyui/themes/icon.css"/>  
    <link rel="stylesheet" type="text/css" href="/css/easyui/themes/gray/easyui.css">  
    <link rel="stylesheet" type="text/css" href="/css/easyui/themes/default/easyui.css">  
    <script type="text/javascript" src="/js/easyui/jquery.min.js"></script>  
    <script type="text/javascript" src="/js/easyui/jquery.easyui.min.js"></script>  
    <script type="text/javascript" src="/js/easyui/easyui-lang-zh_CN.js"></script>  
    <script type="text/javascript" src="/store/smokeBox.js"></script>  
    <script type="text/javascript">
    	$(function(){
    		
     		$('#btn').linkbutton({
    		    iconCls: 'icon-search'
    		});
     	    $('#btn').bind('click', function(){
     	    	query();
     	    });
     		$('#area').combobox({
     		    url:'/store/queryarea',
     		    valueField:'area',
     		    textField:'area'
     		});
     		
    	});
    	
    	function query(){
    		console.log('query');
    		
        	$.ajax({
        		url:'/store/queryData',
        		data: $('#form').serialize(),
        		success: function(data){
        			console.log(data.length);
        			if(data && data.length){
        				var length = data.length;
        				var rows = Math.ceil(length/10); //除以10，向上取整，得到有多少行
        				$('#table').html("");
        				var trHtml = "";
        				for(var i=0;i<rows;i++){
        					//先拼每行的数据
        					var tdHtml = "";
        					for(var j=0;j<10;j++){
        						var storeData = data[i*10+j];
        						console.log("--------"+i+"-----"+j);
        						console.log(storeData);
        						tdHtml = tdHtml + createTdHtml(storeData);
        					}
        					
        					//再把每行的数据放入到table中
        					trHtml = trHtml+'<tr style="height:40px;" id="aa'+i+'">'+tdHtml+'</tr>';
        				}
        				$('#table').append(trHtml);
        				
        				
        			}
        			console.log(data);
       	      	}
        	});    		
    		
    		
    	}
    	
    	function createTdHtml(storeData){
    		var color = '#66ff99';
    		if(storeData.smokeNumber){
    			if(storeData.smokeNumber>=34){
    				color = '#CC5233';
    			}else if(storeData.smokeNumber<=34 && storeData.smokeNumber>0){
    				color = '#FFF68F';
    			}
    		}
    		var vHtml = "";
    		if(color == '#66ff99'){
    			vHtml = storeData.area +"-"+storeData.areaId;
    		}else{
    			vHtml = storeData.area +"-"+storeData.areaId;
    		}
    		
    		return '<td style="background-color: '+color+';height:20px;width:40px;" title="提示信息" class="easyui-tooltip"><input name="selectStore" type="checkbox">'+vHtml+'</td>';
    	}
    	
    </script>
<style type="text/css">
.formLabe {
	height: 30px;
	text-align: right;
	padding-right: 5px;
}

	
</style>
</head>
<body>
<div class="easyui-layout"  fit="true">
    <div data-options="region:'north',split:true" style="height:62px;">
    	<form id="form" action="/#">
	    	<table cellspacing="0" cellpadding="0" style="width:100%;height:40px;border: none;">
	    		<tr style="margin-top: 5px">
	    			<td class="formLabe" style="width:10%;">区域</td>
	    			<td style="width:10%;padding-top: 5px;"><input id="area" name="area"></td>
	    			<td style="width:10%;padding-top: 5px;"><a id="btn" href="#">查询</a></td>
	    		</tr>
	    	</table>
    	</form>
    </div>
    <div data-options="region:'center'" style="background:#eee;">
    			
		<table id="table" cellspacing="5" cellpadding="5" style="width:100%;border: none;">
		</table>
    </div>
</div>

</body>
</html>